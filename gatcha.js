function writeGatcha(a,b,c,f,k){if(void 0===b||null==b)b="side-";if(void 0===k||null==k||1!=k)k=!1;var e=null;if("category"==c){var d=document.querySelectorAll("div.categories a");if(null!=d&&0<d.length){for(var e=[],g=0;g<d.length;g++){var h=d[g].href;0>h.replace(getBlogUrl(),"").indexOf("-")&&0<=h.indexOf(getBlogUrl()+"/archive/category/")&&e.push(d[g])}g=Math.floor(Math.random()*e.length);e=e[g]}}d="";d=void 0!==e&&null!=e?e.href.replace(getBlogUrl()+"/archive/category/",""):"recent"==c?"gatcha-new":
"";void 0!==f&&null!=f?(document.write('<span class="hatena-module-foot"><h3>'+f),500<window.innerWidth?(document.write('<span style="float:right">'),writeForm(b,d,a,k),document.write("</span></h3>")):(document.write("</h3>"),writeForm(b,d,a)),document.write("</span>")):writeForm(b,d,a);document.write('<span id="'+b+'gachaSpan"></span>');switchGatchButton(!1,b)}
function writeForm(a,b,c,f){document.write('<select id="'+a+'inGatchaCategory" onchange="runGatcha(\''+a+'\')" style="width:150px;"><select>');document.write(' <input type="button" id="'+a+'btnNormalGatcha" value=" \u66f4\u65b0 " onClick="runGatcha(\''+a+"')\" />");document.write(' <input type="button" id="'+a+'btnMoveGatcha" value=" \u4e00\u89a7 " onClick="moveGatcha(\''+a+"')\" />");f&&document.write(' <input type="button" id="'+a+'btnFeedlyGatcha" value=" \u8cfc\u8aad " onClick="feedGatcha(\''+
a+"')\" />");document.write('<input type="hidden" id="'+a+'inGatchaNum" value="'+c+'" />');document.write('<input type="hidden" id="'+a+'mode" value="'+b+'" />');a=document.getElementById(a+"inGatchaCategory");a.appendChild(createOption("gatcha-new","\u6700\u65b0"));a.selectedIndex=1}
function writeGatchaCategory(a){if(void 0===a||null==a)a="side-";var b=getBlogUrl(),c=document.getElementById(a+"inGatchaCategory"),b=document.getElementById(a+"mode").value.replace(b+"/archive/category/",""),b=createOption(b,decodeURI(b));c.appendChild(b);b.selected=!0;runGatcha(a)}function createOption(a,b){var c=document.createElement("option");c.value=a;c.text=b;return c}
function switchGatchButton(a,b){document.getElementById(b+"btnNormalGatcha").disabled=!a;document.getElementById(b+"btnMoveGatcha").disabled=!a;document.getElementById(b+"inGatchaCategory").disabled=!a;var c=document.getElementById(b+"btnFeedlyGatcha");null!=c&&(c.disabled=!a)}
function feedGatcha(a){switchGatchButton(!1,a);var b="",b=getBlogUrl(),c=document.getElementById(a+"inGatchaCategory"),f=c.selectedIndex,b=0==f||2==f?b+"/feed":1==f?"http://b.hatena.ne.jp/entrylist?sort=count&mode=rss&url="+encodeURIComponent(b):b+"/rss/category/"+c.value;switchGatchButton(!0,a);window.open("http://cloud.feedly.com/#subscription%2Ffeed%2F"+encodeURIComponent(b))}
function moveGatcha(a){switchGatchButton(!1,a);var b="",b=getBlogUrl(),c=document.getElementById(a+"inGatchaCategory"),f=c.selectedIndex,b=0==f||2==f?b+"/archive":1==f?"http://b.hatena.ne.jp/entrylist?sort=count&url="+encodeURIComponent(b):b+"/archive/category/"+c.value;switchGatchButton(!0,a);location.href=b}
function runGatcha(a){switchGatchButton(!1,a);var b=document.getElementById(a+"inGatchaCategory"),c=b.selectedIndex;0==c?runNewGatcha(a):1==c?runNewGatcha(a):runCategoryGatcha(a,b.value);switchGatchButton(!0,a)}
function runCommonGatcha(a,b){var c=document.getElementById(a+"inGatchaNum").value;$.ajax({url:b,type:"get",dataType:"xml",timeout:5E3,success:function(b,k){if("success"===k){var e=0,d=[],g;$(b).find("item").each(function(){d[e]={};$(this).children().each(function(){g=$(this)[0].nodeName;d[e][g]={};attributes=$(this)[0].attributes;for(var a in attributes)d[e][g][attributes[a].name]=attributes[a].value;d[e][g].text=$(this).text()});e++});var h=[],l;for(l in d){var m={};m.link=d[l].link.text;h.push(m)}h=
removeThisEntry(h);console.log(h);l=document.getElementById(a+"gachaSpan");createOwnHtml(l,null,h,null,c)}}})}function runNewGatcha(a){var b=getBlogUrl();runCommonGatcha(a,b+"/rss")}function runCategoryGatcha(a,b){var c=getBlogUrl()+"/rss/category/"+b;runCommonGatcha(a,c)};
